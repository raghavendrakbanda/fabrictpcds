
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.call_center') DROP VIEW TPCDS.call_center
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.catalog_page') DROP VIEW TPCDS.catalog_page
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.catalog_returns') DROP VIEW TPCDS.catalog_returns
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.catalog_sales') DROP VIEW TPCDS.catalog_sales
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.customer') DROP VIEW TPCDS.customer
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.customer_address') DROP VIEW TPCDS.customer_address
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.customer_demographics') DROP VIEW TPCDS.customer_demographics
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.date_dim') DROP VIEW TPCDS.date_dim
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.household_demographics') DROP VIEW TPCDS.household_demographics
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.income_band') DROP VIEW TPCDS.income_band
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.inventory') DROP VIEW TPCDS.inventory
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.item') DROP VIEW TPCDS.item
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.promotion') DROP VIEW TPCDS.promotion
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.reason') DROP VIEW TPCDS.reason
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.ship_mode') DROP VIEW TPCDS.ship_mode
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.store') DROP VIEW TPCDS.store
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.store_returns') DROP VIEW TPCDS.store_returns
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.store_sales') DROP VIEW TPCDS.store_sales
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.time_dim') DROP VIEW TPCDS.time_dim
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.warehouse') DROP VIEW TPCDS.warehouse
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.web_page') DROP VIEW TPCDS.web_page
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.web_returns') DROP VIEW TPCDS.web_returns
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.web_sales') DROP VIEW TPCDS.web_sales
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'VIEW' AND CONCAT(TABLE_SCHEMA, '.', TABLE_NAME) = 'TPCDS.web_site') DROP VIEW TPCDS.web_site
GO


CREATE VIEW TPCDS.call_center AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/call_center/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (cc_call_center_sk INT,cc_call_center_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,cc_rec_start_date DATE,cc_rec_end_date DATE,cc_closed_date_sk INT,cc_open_date_sk INT,cc_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cc_class VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cc_employees INT,cc_sq_ft INT,cc_hours CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,cc_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,cc_mkt_id INT,cc_mkt_class CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cc_mkt_desc VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,cc_market_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,cc_division INT,cc_division_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cc_company INT,cc_company_name CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cc_street_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,cc_street_name VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,cc_street_type CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,cc_suite_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,cc_city VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,cc_county VARCHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,cc_state CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,cc_zip CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,cc_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,cc_gmt_offset numeric(5, 2),cc_tax_percentage numeric(5, 2)) AS [r]
GO
CREATE VIEW TPCDS.catalog_page AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/catalog_page/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (cp_catalog_page_sk INT,cp_catalog_page_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,cp_start_date_sk INT,cp_end_date_sk INT,cp_department VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,cp_catalog_number INT,cp_catalog_page_number INT,cp_description VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,cp_type VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.catalog_returns AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/catalog_returns/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (cr_returned_date_sk INT, cr_returned_time_sk INT,cr_item_sk INT,cr_refunded_customer_sk INT,cr_refunded_cdemo_sk INT,cr_refunded_hdemo_sk INT,cr_refunded_addr_sk INT,cr_returning_customer_sk INT,cr_returning_cdemo_sk INT,cr_returning_hdemo_sk INT,cr_returning_addr_sk INT,cr_call_center_sk INT,cr_catalog_page_sk INT,cr_ship_mode_sk INT,cr_warehouse_sk INT,cr_reason_sk INT,cr_order_number BIGINT,cr_return_quantity INT,cr_return_amount numeric(7, 2),cr_return_tax numeric(7, 2),cr_return_amt_inc_tax numeric(7, 2),cr_fee numeric(7, 2),cr_return_ship_cost numeric(7, 2),cr_refunded_cash numeric(7, 2),cr_reversed_charge numeric(7, 2),cr_store_credit numeric(7, 2),cr_net_loss numeric(7, 2)) AS [r]
GO
CREATE VIEW TPCDS.catalog_sales AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/catalog_sales/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (cs_sold_date_sk INT, cs_sold_time_sk INT,cs_ship_date_sk INT,cs_bill_customer_sk INT,cs_bill_cdemo_sk INT,cs_bill_hdemo_sk INT,cs_bill_addr_sk INT,cs_ship_customer_sk INT,cs_ship_cdemo_sk INT,cs_ship_hdemo_sk INT,cs_ship_addr_sk INT,cs_call_center_sk INT,cs_catalog_page_sk INT,cs_ship_mode_sk INT,cs_warehouse_sk INT,cs_item_sk INT,cs_promo_sk INT,cs_order_number BIGINT,cs_quantity INT,cs_wholesale_cost numeric(7, 2),cs_list_price numeric(7, 2),cs_sales_price numeric(7, 2),cs_ext_discount_amt numeric(7, 2),cs_ext_sales_price numeric(7, 2),cs_ext_wholesale_cost numeric(7, 2),cs_ext_list_price numeric(7, 2),cs_ext_tax numeric(7, 2),cs_coupon_amt numeric(7, 2),cs_ext_ship_cost numeric(7, 2),cs_net_paid numeric(7, 2),cs_net_paid_inc_tax numeric(7, 2),cs_net_paid_inc_ship numeric(7, 2),cs_net_paid_inc_ship_tax numeric(7, 2),cs_net_profit numeric(7, 2)) AS [r]
GO
CREATE VIEW TPCDS.customer AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/customer/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (c_customer_sk INT,c_customer_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,c_current_cdemo_sk INT,c_current_hdemo_sk INT,c_current_addr_sk INT,c_first_shipto_date_sk INT,c_first_sales_date_sk INT,c_salutation CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,c_first_name CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,c_last_name CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,c_preferred_cust_flag CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,c_birth_day INT,c_birth_month INT,c_birth_year INT,c_birth_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,c_login CHAR(13) COLLATE Latin1_General_100_BIN2_UTF8,c_email_address CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,c_last_review_date VARCHAR(7) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.customer_address AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/customer_address/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (ca_address_sk INT,ca_address_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,ca_street_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,ca_street_name VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,ca_street_type CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,ca_suite_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,ca_city VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,ca_county VARCHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,ca_state CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,ca_zip CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,ca_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,ca_gmt_offset numeric(5, 2),ca_location_type CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.customer_demographics AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/customer_demographics/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (cd_demo_sk INT,cd_gender CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,cd_marital_status CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,cd_education_status CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,cd_purchase_estimate INT,cd_credit_rating CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,cd_dep_count INT,cd_dep_employed_count INT,cd_dep_college_count INT) AS [r]
GO
CREATE VIEW TPCDS.date_dim AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/date_dim/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (d_date_sk INT,d_date_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,d_date DATE,d_month_seq INT,d_week_seq INT,d_quarter_seq INT,d_year INT,d_dow INT,d_moy INT,d_dom INT,d_qoy INT,d_fy_year INT,d_fy_quarter_seq INT,d_fy_week_seq INT,d_day_name CHAR(9) COLLATE Latin1_General_100_BIN2_UTF8,d_quarter_name CHAR(6) COLLATE Latin1_General_100_BIN2_UTF8,d_holiday CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_weekend CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_following_holiday CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_first_dom INT,d_last_dom INT,d_same_day_ly INT,d_same_day_lq INT,d_current_day CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_current_week CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_current_month CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_current_quarter CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,d_current_year CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.household_demographics AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/household_demographics/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (hd_demo_sk INT,hd_income_band_sk INT,hd_buy_potential CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,hd_dep_count INT,hd_vehicle_count INT) AS [r]
GO
CREATE VIEW TPCDS.income_band AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/income_band/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (ib_income_band_sk INT,ib_lower_bound INT,ib_upper_bound INT) AS [r]
GO
CREATE VIEW TPCDS.inventory AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/inventory/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (inv_date_sk INT, inv_item_sk INT,inv_warehouse_sk INT,inv_quantity_on_hand INT) AS [r]
GO
CREATE VIEW TPCDS.item AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/item/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (i_item_sk INT,i_item_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,i_rec_start_date DATE,i_rec_end_date DATE,i_item_desc VARCHAR(200) COLLATE Latin1_General_100_BIN2_UTF8,i_current_price numeric(7, 2),i_wholesale_cost numeric(7, 2),i_brand_id INT,i_brand CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,i_class_id INT,i_class CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,i_category_id INT,i_category CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,i_manufact_id INT,i_manufact CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,i_size CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,i_formulation CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,i_color CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,i_units CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,i_container CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,i_manager_id INT,i_product_name CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.promotion AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/promotion/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (p_promo_sk INT,p_promo_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,p_start_date_sk INT,p_end_date_sk INT,p_item_sk INT,p_cost numeric(15, 2),p_response_target INT,p_promo_name CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_dmail CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_email CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_catalog CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_tv CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_radio CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_press CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_event CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_demo CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,p_channel_details VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,p_purpose CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,p_discount_active CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.reason AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/reason/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (r_reason_sk INT,r_reason_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,r_reason_desc VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.ship_mode AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/ship_mode/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (sm_ship_mode_sk INT,sm_ship_mode_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,sm_type CHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,sm_code CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,sm_carrier CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,sm_contract CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.store AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/store/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (s_store_sk INT,s_store_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,s_rec_start_date DATE,s_rec_end_date DATE,s_closed_date_sk INT,s_store_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,s_number_employees INT,s_floor_space INT,s_hours CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,s_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,s_market_id INT,s_geography_class VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,s_market_desc VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,s_market_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,s_division_id INT,s_division_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,s_company_id INT,s_company_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,s_street_number VARCHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,s_street_name VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,s_street_type CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,s_suite_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,s_city VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,s_county VARCHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,s_state CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,s_zip CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,s_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,s_gmt_offset numeric(5, 2),s_tax_precentage numeric(5, 2)) AS [r]
GO
--CREATE VIEW TPCDS.store_returns AS SELECT CONVERT(INT, REPLACE(r.filepath(1), 'sr_returned_date_sk=', '')) AS sr_returned_date_sk, * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/store_returns/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (sr_return_time_sk INT,sr_item_sk INT,sr_customer_sk INT,sr_cdemo_sk INT,sr_hdemo_sk INT,sr_addr_sk INT,sr_store_sk INT,sr_reason_sk INT,sr_ticket_number BIGINT,sr_return_quantity INT,sr_return_amt numeric(7, 2),sr_return_tax numeric(7, 2),sr_return_amt_inc_tax numeric(7, 2),sr_fee numeric(7, 2),sr_return_ship_cost numeric(7, 2),sr_refunded_cash numeric(7, 2),sr_reversed_charge numeric(7, 2),sr_store_credit numeric(7, 2),sr_net_loss numeric(7, 2)) AS [r]
CREATE VIEW TPCDS.store_returns AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/store_returns/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (sr_returned_date_sk INT,sr_return_time_sk INT,sr_item_sk INT,sr_customer_sk INT,sr_cdemo_sk INT,sr_hdemo_sk INT,sr_addr_sk INT,sr_store_sk INT,sr_reason_sk INT,sr_ticket_number BIGINT,sr_return_quantity INT,sr_return_amt numeric(7, 2),sr_return_tax numeric(7, 2),sr_return_amt_inc_tax numeric(7, 2),sr_fee numeric(7, 2),sr_return_ship_cost numeric(7, 2),sr_refunded_cash numeric(7, 2),sr_reversed_charge numeric(7, 2),sr_store_credit numeric(7, 2),sr_net_loss numeric(7, 2)) AS [r]
GO
CREATE VIEW TPCDS.store_sales AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/store_sales/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (ss_sold_date_sk INT, ss_sold_time_sk INT,ss_item_sk INT,ss_customer_sk INT,ss_cdemo_sk INT,ss_hdemo_sk INT,ss_addr_sk INT,ss_store_sk INT,ss_promo_sk INT,ss_ticket_number BIGINT,ss_quantity INT,ss_wholesale_cost numeric(7, 2),ss_list_price numeric(7, 2),ss_sales_price numeric(7, 2),ss_ext_discount_amt numeric(7, 2),ss_ext_sales_price numeric(7, 2),ss_ext_wholesale_cost numeric(7, 2),ss_ext_list_price numeric(7, 2),ss_ext_tax numeric(7, 2),ss_coupon_amt numeric(7, 2),ss_net_paid numeric(7, 2),ss_net_paid_inc_tax numeric(7, 2),ss_net_profit numeric(7, 2)) AS [r]
GO

CREATE VIEW TPCDS.time_dim AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/time_dim/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (t_time_sk INT,t_time_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,t_time INT,t_hour INT,t_minute INT,t_second INT,t_am_pm CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,t_shift CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,t_sub_shift CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,t_meal_time CHAR(20) COLLATE Latin1_General_100_BIN2_UTF8) AS [r]
GO
CREATE VIEW TPCDS.warehouse AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/warehouse/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (w_warehouse_sk INT,w_warehouse_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,w_warehouse_name VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,w_warehouse_sq_ft INT,w_street_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,w_street_name VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,w_street_type CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,w_suite_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,w_city VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,w_county VARCHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,w_state CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,w_zip CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,w_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,w_gmt_offset numeric(5, 2)) AS [r]
GO
CREATE VIEW TPCDS.web_page AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/web_page/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (wp_web_page_sk INT,wp_web_page_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,wp_rec_start_date DATE,wp_rec_end_date DATE,wp_creation_date_sk INT,wp_access_date_sk INT,wp_autogen_flag CHAR(1) COLLATE Latin1_General_100_BIN2_UTF8,wp_customer_sk INT,wp_url VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,wp_type CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,wp_char_count INT,wp_link_count INT,wp_image_count INT,wp_max_ad_count INT) AS [r]
GO
CREATE VIEW TPCDS.web_returns AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/web_returns/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (wr_returned_date_sk INT, wr_returned_time_sk INT,wr_item_sk INT,wr_refunded_customer_sk INT,wr_refunded_cdemo_sk INT,wr_refunded_hdemo_sk INT,wr_refunded_addr_sk INT,wr_returning_customer_sk INT,wr_returning_cdemo_sk INT,wr_returning_hdemo_sk INT,wr_returning_addr_sk INT,wr_web_page_sk INT,wr_reason_sk INT,wr_order_number BIGINT,wr_return_quantity INT,wr_return_amt numeric(7, 2),wr_return_tax numeric(7, 2),wr_return_amt_inc_tax numeric(7, 2),wr_fee numeric(7, 2),wr_return_ship_cost numeric(7, 2),wr_refunded_cash numeric(7, 2),wr_reversed_charge numeric(7, 2),wr_account_credit numeric(7, 2),wr_net_loss numeric(7, 2)) AS [r]
GO
CREATE VIEW TPCDS.web_sales AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/web_sales/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (ws_sold_date_sk INT, ws_sold_time_sk INT,ws_ship_date_sk INT,ws_item_sk INT,ws_bill_customer_sk INT,ws_bill_cdemo_sk INT,ws_bill_hdemo_sk INT,ws_bill_addr_sk INT,ws_ship_customer_sk INT,ws_ship_cdemo_sk INT,ws_ship_hdemo_sk INT,ws_ship_addr_sk INT,ws_web_page_sk INT,ws_web_site_sk INT,ws_ship_mode_sk INT,ws_warehouse_sk INT,ws_promo_sk INT,ws_order_number BIGINT,ws_quantity INT,ws_wholesale_cost numeric(7, 2),ws_list_price numeric(7, 2),ws_sales_price numeric(7, 2),ws_ext_discount_amt numeric(7, 2),ws_ext_sales_price numeric(7, 2),ws_ext_wholesale_cost numeric(7, 2),ws_ext_list_price numeric(7, 2),ws_ext_tax numeric(7, 2),ws_coupon_amt numeric(7, 2),ws_ext_ship_cost numeric(7, 2),ws_net_paid numeric(7, 2),ws_net_paid_inc_tax numeric(7, 2),ws_net_paid_inc_ship numeric(7, 2),ws_net_paid_inc_ship_tax numeric(7, 2),ws_net_profit numeric(7, 2)) AS [r]
GO
CREATE VIEW TPCDS.web_site AS SELECT * FROM OPENROWSET(BULK 'raw/tpc-ds/source_files_001TB_parquet/web_site/*.parquet', FORMAT='PARQUET', DATA_SOURCE = 'TPCDataSource') WITH (web_site_sk INT,web_site_id CHAR(16) COLLATE Latin1_General_100_BIN2_UTF8,web_rec_start_date DATE,web_rec_end_date DATE,web_name VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,web_open_date_sk INT,web_close_date_sk INT,web_class VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,web_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,web_mkt_id INT,web_mkt_class VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,web_mkt_desc VARCHAR(100) COLLATE Latin1_General_100_BIN2_UTF8,web_market_manager VARCHAR(40) COLLATE Latin1_General_100_BIN2_UTF8,web_company_id INT,web_company_name CHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,web_street_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,web_street_name VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,web_street_type CHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,web_suite_number CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,web_city VARCHAR(60) COLLATE Latin1_General_100_BIN2_UTF8,web_county VARCHAR(30) COLLATE Latin1_General_100_BIN2_UTF8,web_state CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,web_zip CHAR(10) COLLATE Latin1_General_100_BIN2_UTF8,web_country VARCHAR(20) COLLATE Latin1_General_100_BIN2_UTF8,web_gmt_offset numeric(5, 2),web_tax_percentage numeric(5, 2)) AS [r]
GO

